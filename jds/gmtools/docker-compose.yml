services:
  gmserver:
    image: registry.cn-chengdu.aliyuncs.com/havario/gmserver:latest
    container_name: gmserver
    restart: unless-stopped
    ports:
      - 3000:3000
    environment:
      GMDB_HOST: 192.168.250.250
      GMDB_DATABASE: dev_gm
      GMDB_USER: root
      GMDB_PASSWORD: 123456
      GMDB_PORT: 3306
      REPORTDB_HOST: 192.168.250.250
      REPORTDB_DATABASE: dev_report
      REPORTDB_USER: root
      REPORTDB_PASSWORD: 123456
      REPORTDB_PORT: 3306
      ACCOUNTDB_HOST: 192.168.250.250
      ACCOUNTDB_DATABASE: dev_account
      ACCOUNTDB_USER: root
      ACCOUNTDB_PASSWORD: 123456
      ACCOUNTDB_PORT: 3306
      CENTERDB_HOST: 192.168.250.250
      CENTERDB_DATABASE: dev_common
      CENTERDB_USER: root
      CENTERDB_PASSWORD: 123456
      CENTERDB_PORT: 3306
      GMGAME_HOST: 192.168.250.251
      GMGAME_PORT: 6090 # 对接游戏进程GM
      OBS_ACCESS_KEY_ID: 123456
      OBS_SECRET_ACCESS_KEY: 123456
      OBS_SERVER: 123456
      OBS_BUCKET: 123456
      OBS_NOTIC_KEY: 123456
      OBS_SERVERLIST_KEY: 123456
      OBS_SERVERLIST_NAME: 123456
      OBS_REFRESH_ACCESSKEY: 123456
      OBS_REFRESH_SECRETKEY: 123456
      OBS_REFRESH_PROJECTID: 123456
    volumes:
      - ./gm-server/config:/gm-server/config
      - ./gm-server/logs:/gm-server/logs
      - ./gm-server/upload:/gm-server/upload
    privileged: true
    networks:
      - gmtools

  gmetl:
    image: registry.cn-chengdu.aliyuncs.com/havario/gmetl:latest
    container_name: gmetl
    restart: unless-stopped
    environment:
      REPORTDB_HOST: 192.168.250.250
      REPORTDB_PORT: 3306
      REPORTDB_USER: root
      REPORTDB_PASSWORD: 123456
      REPORTDB_DATABASE: dev_report
    volumes:
      - ./gm-etl/config:/gm-etl/config
      - ./gm-etl/data:/gm-etl/data
      - ./gm-etl/logs:/gm-etl/logs
    depends_on:
      - gmserver
    networks:
      - gmtools

  gmweb:
    image: registry.cn-chengdu.aliyuncs.com/havario/gmweb:latest
    container_name: gmweb
    restart: unless-stopped
    ports:
      - 80:80
    environment:
      HTML_TITLE: p8-gmtools
      GMSERVER_PUBLIC_IP: 192.168.250.250
      GMSERVER_PUBLIC_PORT: 3000
    volumes:
      - ./gm-web/config:/gm-web/config
      - ./gm-web/setup.js:/gm-web/src/globle/setup.js
    depends_on:
      - gmserver
      - gmetl
    networks:
      - gmtools

networks:
  gmtools:
    driver: bridge